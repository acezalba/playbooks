---
- name: Gather system facts
  ansible.builtin.gather_facts:

- name: Populate service facts
  ansible.builtin.service_facts:

- name: Pass datetime for use on filename
  shell: "date +%Y%m%d%H%M%S"
  register: datetime
  no_log: true

- name: Transform project name for templating
  ansible.builtin.set_fact:
    project_name_cleaned: "{{ project_name | trim() | lower() | replace(' ','_') }}"
  no_log: true

- name: Transform autogenerated values for project
  ansible.builtin.set_fact:
    site_title: "{{ project_name_cleaned | replace('_', '-') | capitalize() }}"
    project_url: "{{ project_name_cleaned | replace('_', '') }}.test"
    wp_user_password: "{{ lookup('password', '/dev/null chars=ascii_letters,digit length=30') | lower }}"
    current_path: "{{ lookup('env', 'PWD') }}"
  no_log: true

- name: Create a folder in the current working directory
  ansible.builtin.file:
    path: "{{ current_path }}/{{ project_name_cleaned }}"
    state: directory
  register: project_path